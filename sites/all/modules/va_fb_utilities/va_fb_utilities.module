<?php
/**
 * @file
 * Code for the VA Banner feature.
 */


function  va_fb_utilities_block_info() {
  // This hook returns an array, each component of which is an array of block
  // information. The array keys are the 'delta' values used in other block
  // hooks.

  // The required block information is a block description, which is shown
  // to the site administrator in the list of possible blocks. You can also
  // provide initial settings for block weight, status, etc.

  // Many options are defined in hook_block_info():
  $blocks['fb_iframe'] = array(
    // info: The name of the block.
    'info' => t('Facebook Like Box'),
    // Block caching options (per role, per user, etc.)
    'cache' => DRUPAL_CACHE_PER_ROLE, // default
  );

 $blocks['fb_like_button'] = array(
    // info: The name of the block.
    'info' => t('Facebook Like Button'),
    // Block caching options (per role, per user, etc.)
    'cache' => DRUPAL_CACHE_PER_ROLE, // default
);

  $blocks['fb_sharer'] = array(
    // info: The name of the block.
    'info' => t('Facebook Share This'),
    // Block caching options (per role, per user, etc.)
    'cache' => DRUPAL_CACHE_PER_ROLE, // default
  );






 return $blocks;
}


function   va_fb_utilities_block_view($delta = '') {
  //The $delta parameter tells us which block is being requested.
  switch ($delta) {
    case 'fb_iframe':
      // The subject is displayed at the top of the block. Note that it
      // should be passed through t() for translation. The title configured
      // for the block using Drupal UI supercedes this one.
      $block['subject'] = t('Facebook Like Box');
      // The content of the block is typically generated by calling a custom
      // function.
      $block['content'] = fb_iframe();
      break;

  case 'fb_like_button':
      // The subject is displayed at the top of the block. Note that it
      // should be passed through t() for translation. The title configured
      // for the block using Drupal UI supercedes this one.
      $block['subject'] = t('Facebook Like Button');
      // The content of the block is typically generated by calling a custom
      // function.
      $block['content'] = fb_like_button();
      break;
case 'fb_sharer':
      // The subject is displayed at the top of the block. Note that it
      // should be passed through t() for translation. The title configured
      // for the block using Drupal UI supercedes this one.
      $block['subject'] = t('Facebook Share This');
      // The content of the block is typically generated by calling a custom
      // function.
      $block['content'] = fb_sharer();
      break;







  }
  return $block;
}

function   va_fb_utilities_block_save($delta = '', $edit = array()) {

  if ($delta == 'fb_iframe') {
    variable_set('fb_url', $edit['fb_url']);
  variable_set('fb_id', $edit['fb_id']);
  variable_set('fb_width', $edit['fb_width']);
  variable_set('fb_height', $edit['fb_height']);
  variable_set('fb_border', $edit['fb_border']);
  variable_set('fb_faces', $edit['fb_faces']);
  variable_set('fb_stream', $edit['fb_stream']);
  variable_set('fb_scheme', $edit['fb_scheme']);
  variable_set('fb_header', $edit['fb_header']);
  }
elseif($delta == 'fb_like_box') {
    variable_set('fb_like_box_url', $edit['fb_like_box_url']);
  }
elseif($delta == 'social_icons') {
    variable_set('fb_url', $edit['fb_url']);
  variable_set('twitter_url', $edit['twitter_url']);
  variable_set('rss_url', $edit['rss_url']);
  variable_set('youtube_url', $edit['youtube_url']);
  variable_set('vimeo_url', $edit['vimeo_url']);
  variable_set('linkedin_url', $edit['linkedin_url']);
  variable_set('instagram_url', $edit['instagram_url']);
  variable_set('pinterest_url', $edit['pinterest_url']);

  variable_set('trip_advisor_url', $edit['trip_advisor_url']);
  variable_set('foursquare_url', $edit['foursquare_url']);
  variable_set('google_plus_url', $edit['google_plus_url']);
  variable_set('true_local_url', $edit['true_local_url']);


  }
elseif($delta == 'mailchimp_link') {
      variable_set('mailchimp_url', $edit['mailchimp_url']);
    variable_set('mailchimp_text', $edit['mailchimp_text']);
   }


}

function   va_fb_utilities_block_configure($delta = '') {

  $form = array();

if ($delta == 'fb_iframe') {
    $form['fb_url'] = array(
      '#type' => 'textfield',
      '#title' => t('URL of Facebook page'),
      '#default_value' => variable_get('fb_url', 'http://www.thevariousartists.com.au'),
     );

   $form['fb_id'] = array(
        '#type' => 'textfield',
        '#title' => t('IDL of Facebook page'),
        '#default_value' => variable_get('fb_id', '324784016109'),
       );

   $form['fb_width'] = array(
        '#type' => 'textfield',
        '#title' => t('Width of widget'),
        '#default_value' => variable_get('fb_width', '300'),
       );

  $form['fb_height'] = array(
          '#type' => 'textfield',
          '#title' => t('Height of widget'),
          '#default_value' => variable_get('fb_height', '300'),
      );
  $form['fb_border'] = array(
    '#type' => 'textfield',
    '#title' => t('Hex value of border - dont include the #'),
        '#default_value' => variable_get('fb_border', 'FFFFFF'),
  );

  $form['fb_scheme'] = array(
      '#title' => t('Colour Scheme'),
       '#default_value' => variable_get('fb_scheme', 'light'),
    '#type' => 'select',
    '#options' => array(
        'light' => 'Light',
      'dark' => 'Dark',
      )
  );
  $form['fb_header'] = array(
      '#title' => t('Show Header'),
       '#default_value' => variable_get('fb_header', 'false'),
    '#type' => 'select',
    '#options' => array(
        'true' => 'True',
      'false' => 'False',
      )
  );

  $form['fb_faces'] = array(
      '#title' => t('Show Faces'),
       '#default_value' => variable_get('fb_faces', 'true'),
    '#type' => 'select',
    '#options' => array(
        'true' => 'True',
      'false' => 'False',
      )
  );


  $form['fb_stream'] = array(
      '#title' => t('Show Stream'),
       '#default_value' => variable_get('fb_stream', 'false'),
    '#type' => 'select',
    '#options' => array(
        'true' => 'True',
      'false' => 'False',
      )
  );
  }
elseif($delta == 'fb_like_box') {
    $form['fb_like_box_url'] = array(
      '#type' => 'textfield',
      '#title' => t('URL of Facebook page'),
      '#default_value' => variable_get('fb_like_box_url', 'http://www.thevariousartists.com.au'),
     );
  }
elseif($delta == 'social_icons') {
   $form['fb_url'] = array(
      '#type' => 'textfield',
      '#title' => t('URL of your Facebook page'),
      '#default_value' => variable_get('fb_url', 'http://www.thevariousartists.com.au'),
     );
   $form['twitter_url'] = array(
        '#type' => 'textfield',
        '#title' => t('URL of your Twitter Account'),
        '#default_value' => variable_get('twitter_url', 'http://www.thevariousartists.com.au'),
    );
  $form['rss_url'] = array(
        '#type' => 'textfield',
        '#title' => t('URL of your RSS Feed'),
        '#default_value' => variable_get('rss_url', 'http://www.thevariousartists.com.au'),
    );
  $form['youtube_url'] = array(
        '#type' => 'textfield',
        '#title' => t('URL of your Youtube Channel'),
        '#default_value' => variable_get('youtube_url', 'http://www.thevariousartists.com.au'),
    );
  $form['vimeo_url'] = array(
        '#type' => 'textfield',
        '#title' => t('URL of your Vimeo Channel'),
        '#default_value' => variable_get('vimeo_url', 'http://www.thevariousartists.com.au'),
    );

  $form['linkedin_url'] = array(
        '#type' => 'textfield',
        '#title' => t('URL of your LinkedIn Profile'),
        '#default_value' => variable_get('linkedin_url', 'http://www.thevariousartists.com.au'),
    );

  $form['instagram_url'] = array(
        '#type' => 'textfield',
        '#title' => t('URL of your Instagram Profile'),
        '#default_value' => variable_get('instagram_url', 'http://www.thevariousartists.com.au'),
    );

  $form['pinterest_url'] = array(
        '#type' => 'textfield',
        '#title' => t('URL of your Pinterest'),
        '#default_value' => variable_get('pinterest_url', 'http://www.thevariousartists.com.au'),
    );

  $form['trip_advisor_url'] = array(
        '#type' => 'textfield',
        '#title' => t('URL of your Trip advisor Page'),
        '#default_value' => variable_get('trip_advisor_url', 'http://www.thevariousartists.com.au'),
    );

  $form['foursquare_url'] = array(
        '#type' => 'textfield',
        '#title' => t('URL of your Four Square Page'),
        '#default_value' => variable_get('foursquare_url', 'http://www.thevariousartists.com.au'),
    );
  $form['google_plus_url'] = array(
        '#type' => 'textfield',
        '#title' => t('URL of your Google Plus'),
        '#default_value' => variable_get('google_plus_url', 'http://www.thevariousartists.com.au'),
    );
  $form['true_local_url'] = array(
        '#type' => 'textfield',
        '#title' => t('URL of your True Local'),
        '#default_value' => variable_get('true_local_url', 'http://www.thevariousartists.com.au'),
    );
  }
elseif($delta == 'mailchimp_link') {
    $form['mailchimp_url'] = array(
      '#type' => 'textfield',
      '#title' => t('URL of Mailchimp Signup page - like http://eepurl.com/xx6iX'),
      '#default_value' => variable_get('mailchimp_url', 'http://eepurl.com/xx6iX'),
     );

   $form['mailchimp_text'] = array(
        '#type' => 'textfield',
        '#title' => t('Text for the link - like Subscribe here'),
        '#default_value' => variable_get('mailchimp_text', 'Subscribe here'),
       );
  }



  return $form;
}


function fb_iframe(){



    drupal_add_css(drupal_get_path('module', 'va_fb') .'/css/va_fb.css');
    //$var ='<iframe src="//www.facebook.com/plugins/likebox.php?href='.variable_get('fb_url', 'http://www.thevariousartists.com.au') .'&amp;width='.variable_get('fb_width', '300').'&amp;height='.variable_get('fb_height', '300').'&amp;colorscheme=dark&amp;show_faces=true&amp;border_color=%23fffffff&amp;stream=true&amp;header=true&amp;appId=264636873547263" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:666px; height:590px;" allowTransparency="true"></iframe>'
    $var ='<iframe src="//www.facebook.com/plugins/likebox.php?href='.variable_get('fb_url', 'http://www.thevariousartists.com.au') .'&amp;width='.variable_get('fb_width', '300').'&amp;height='.variable_get('fb_height', '300').'&amp;colorscheme='.variable_get('fb_scheme', 'light').'&amp;show_faces='.variable_get('fb_faces', 'false').'&amp;border_color=%23'.variable_get('fb_border', 'FFFFFF').'&amp;stream='.variable_get('fb_stream', 'false').'&amp;header='.variable_get('fb_header', 'true').'&amp;appId=264636873547263" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:'.variable_get('fb_width', '300').'px; height:'.variable_get('fb_height', '300').'px;" allowTransparency="true"></iframe>';
    return  $var;




  }

  function fb_sharer(){
$var = '<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=264636873547263&version=v2.0";
  fjs.parentNode.insertBefore(js, fjs);
}(document, "script", "facebook-jssdk"));</script>';




$var .='<div  class="fb-share-button" data-href="http://' .$_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI'] .'" data-type="button_count"></div>';
    return  $var;




  }
function fb_like_button(){
  drupal_add_css(drupal_get_path('module', 'va_social') .'/css/va_fb.css');
  $ret = '<div id="fb-root"></div>
  <script>(function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=264636873547263";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, "script", "facebook-jssdk"));</script>';

  $ret .= '<fb:like href="'.variable_get('fb_like_box_url', 'http://www.thevariousartists.com.au').'" send="true" width="450" show_faces="true"></fb:like>';
  return  $ret;
}



